<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>FPGA Programming Server</title>
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css"
    />
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
  </head>
  <body>
    <div class="container mt-4">
      <h1>FPGA Programming Server</h1>

      <!-- HW Server Selection -->
      <form id="global-settings" class="mb-3">
        <label for="hw_server"><b>Xilinx HW Server:</b></label>
        <select id="hw_server" name="hw_server">
          {% for server in xilinx_servers %}
          <option
            value="{{ server.address }}"
            {%
            if
            loop.first
            %}selected{%
            endif
            %}
          >
            {{ server.name }}
          </option>
          {% endfor %}
        </select>
      </form>

      <!-- Tabs -->
      <ul class="nav nav-tabs" id="progTabs" role="tablist">
        <li class="nav-item" role="presentation">
          <button
            class="nav-link active"
            id="fpga-tab"
            data-bs-toggle="tab"
            data-bs-target="#fpga"
            type="button"
            role="tab"
          >
            Program FPGA
          </button>
        </li>
        <li class="nav-item" role="presentation">
          <button
            class="nav-link"
            id="flash-tab"
            data-bs-toggle="tab"
            data-bs-target="#flash"
            type="button"
            role="tab"
          >
            Program Flash Memory
          </button>
        </li>
      </ul>

      <div class="tab-content mt-3">
        <!-- ----- Tab 1: FPGA ---- -->
        <div class="tab-pane fade show active" id="fpga" role="tabpanel">
          <form id="fpga-form" enctype="multipart/form-data">
            <input type="hidden" name="hw_server" id="hidden_hw_server_fpga" />
            <div class="mb-3">
              <label for="bitfile" class="form-label"
                >Choose bit/bin file</label
              >
              <input
                type="file"
                name="bitfile"
                id="bitfile"
                class="form-control"
                required
              />
            </div>
            <div class="mb-3">
              <label for="ltxfile" class="form-label"
                >Choose ltx file (optional)</label
              >
              <input
                type="file"
                name="ltxfile"
                id="ltxfile"
                class="form-control"
              />
            </div>
            <button type="submit" class="btn btn-primary">Program FPGA</button>
          </form>
          <pre
            id="fpga-output"
            class="mt-3 bg-light p-2"
            style="height: 300px; overflow: auto"
          ></pre>
        </div>

        <!-- ----- Tab 2: Flash Memory ---- -->
        <div class="tab-pane fade" id="flash" role="tabpanel">
          <form id="flash-form" enctype="multipart/form-data">
            <input type="hidden" name="hw_server" id="hidden_hw_server_flash" />
            <div class="mb-3">
              <label for="binfile" class="form-label">Choose bin file</label>
              <input
                type="file"
                name="binfile"
                id="binfile"
                class="form-control"
                required
              />
              <div class="form-check form-check-inline mt-2">
                <input
                  class="form-check-input"
                  type="checkbox"
                  name="blank_check"
                />
                <label class="form-check-label">BLANK_CHECK</label>
              </div>
              <div class="form-check form-check-inline">
                <input class="form-check-input" type="checkbox" name="erase" />
                <label class="form-check-label">ERASE</label>
              </div>
              <div class="form-check form-check-inline">
                <input
                  class="form-check-input"
                  type="checkbox"
                  name="cfg_program"
                />
                <label class="form-check-label">CFG_PROGRAM</label>
              </div>
              <div class="form-check form-check-inline">
                <input
                  class="form-check-input"
                  type="checkbox"
                  name="verify"
                  checked
                />
                <label class="form-check-label">VERIFY</label>
              </div>
            </div>
            <button type="submit" class="btn btn-primary">
              Program Flash Memory
            </button>
          </form>
          <pre
            id="flash-output"
            class="mt-3 bg-light p-2"
            style="height: 300px; overflow: auto"
          ></pre>
        </div>
      </div>
    </div>

    <script src="{{ url_for('static', filename='scripts.js') }}"></script>
  </body>
</html>
